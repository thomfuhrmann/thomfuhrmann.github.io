System.register(["jimu-core","jimu-arcgis","jimu-ui","esri/geometry/Point","esri/rest/print","esri/rest/support/PrintParameters","esri/rest/support/PrintTemplate"],(function(e,t){var r={},a={},n={},o={},c={},s={},i={};return{setters:[function(e){r.React=e.React,r.ReactDOM=e.ReactDOM},function(e){a.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.Button=e.Button,n.Card=e.Card,n.CardBody=e.CardBody,n.CardFooter=e.CardFooter,n.CardHeader=e.CardHeader,n.Label=e.Label,n.Loading=e.Loading,n.Option=e.Option,n.Select=e.Select,n.TextInput=e.TextInput,n.WidgetPlaceholder=e.WidgetPlaceholder},function(e){o.default=e.default},function(e){c.default=e.default},function(e){s.default=e.default},function(e){i.default=e.default}],execute:function(){e((()=>{var e={72:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M10 4H6c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM22 12h4c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2zm0-6h4v4h-4V6zM10 20H6c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2zm0 6H6v-4h4v4zM26 20h-4c-1.1 0-2 .9-2 2v4c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2v-4c0-1.1-.9-2-2-2z"></path><path d="M28 16h-2c-2.671 0-5.182-1.04-7.071-2.929S16 8.671 16 6V4c0-2.2-1.8-4-4-4H4C1.8 0 0 1.8 0 4v8c0 2.2 1.8 4 4 4h2c2.671 0 5.182 1.04 7.071 2.929S16 23.329 16 26v2c0 2.2 1.8 4 4 4h8c2.2 0 4-1.8 4-4v-8c0-2.2-1.8-4-4-4zm2 12c0 .53-.209 1.031-.589 1.411S28.53 30 28 30h-8c-.53 0-1.031-.209-1.411-.589S18 28.53 18 28v-2c0-6.627-5.373-12-12-12H4c-.53 0-1.031-.209-1.411-.589S2 12.53 2 12V4c0-.53.209-1.031.589-1.411S3.47 2 4 2h8c.53 0 1.031.209 1.411.589S14 3.47 14 4v2c0 6.627 5.373 12 12 12h2c.53 0 1.031.209 1.411.589S30 19.47 30 20v8z"></path></svg>'},294:e=>{"use strict";e.exports=o},191:e=>{"use strict";e.exports=c},641:e=>{"use strict";e.exports=s},347:e=>{"use strict";e.exports=i},826:e=>{"use strict";e.exports=a},891:e=>{"use strict";e.exports=r},726:e=>{"use strict";e.exports=n}},t={};function l(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,l),n.exports}l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var u={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(u),l.d(u,{__set_webpack_public_path__:()=>R,default:()=>x});var e=l(891),t=l(826),r=l(726),a=l(294),n=l(191),o=l(641),c=l(347);const s={_widgetLabel:"Print",heading:"PDF drucken",titleLabel:"Titel",scaleLabel:"MaÃŸstab",formatLabel:"Format","A4 Hochformat":"A4 Hochformat","A4 Hochformat mit Legende":"A4 Hochformat mit Legende","A4 Querformat":"A4 Querformat","A4 Querformat mit Legende":"A4 Querformat mit Legende","A3 Hochformat":"A3 Hochformat","A3 Hochformat mit Legende":"A3 Hochformat mit Legende","A3 Querformat":"A3 Querformat","A3 Querformat mit Legende":"A3 Querformat mit Legende",buttonPrint:"Drucken",buttonCancel:"Abbrechen"},{useState:i,useRef:d,useEffect:m}=e.React,p=[1e4,25e3,5e4,1e5,2e5,5e5,1e6,35e5],f={"A4 Hochformat":[190,265],"A4 Hochformat mit Legende":[190,225],"A4 Querformat":[277,178],"A4 Querformat mit Legende":[277,140],"A3 Hochformat":[277,385],"A3 Hochformat mit Legende":[277,335],"A3 Querformat":[400,264],"A3 Querformat mit Legende":[400,215]};function g({view:t,intl:a,updatePreview:l}){const[u,g]=i("GeoSphere Austria"),[h,v]=i(Object.keys(f)[0]),[b,y]=i(1e4),[M,w]=i(!1),x=d(),R=d();x.current=b,R.current=h;const L=d(null);function C(e){fetch(e.url).then((e=>e.blob())).then((e=>{const t=document.createElement("a");t.setAttribute("href",URL.createObjectURL(e)),t.setAttribute("download","GeoSphere_Maps_Print.pdf"),document.body.appendChild(t),t.click(),document.body.removeChild(t),w(!1)}))}function A(e){"AbortError"===e.name||console.error("Error encountered: ",e)}return m((()=>{const e=t.watch("extent",(()=>{x.current&&R.current&&l(x.current,R.current)}));return()=>{console.log("unmount print"),e.remove()}}),[]),e.React.createElement(r.Card,null,e.React.createElement(r.CardHeader,null,a.formatMessage({id:"heading",defaultMessage:s.heading})),e.React.createElement(r.CardBody,null,e.React.createElement("div",null,M&&e.React.createElement(r.Loading,{type:"indeterminate"})),e.React.createElement(r.Label,{className:"w-100"},a.formatMessage({id:"titleLabel",defaultMessage:s.titleLabel}),e.React.createElement(r.TextInput,{type:"text",onChange:e=>{g(e.target.value)},placeholder:a.formatMessage({id:"titleLabel",defaultMessage:s.titleLabel})})),e.React.createElement(r.Label,{className:"w-100"},a.formatMessage({id:"formatLabel",defaultMessage:s.formatLabel}),e.React.createElement(r.Select,{onChange:e=>{const t=e.target.value;v(t),l(b,t)},value:h},Object.keys(f).map((t=>e.React.createElement(r.Option,{key:`${t}`,value:`${t}`},a.formatMessage({id:t,defaultMessage:s[t]})))))),e.React.createElement(r.Label,{className:"w-100"},a.formatMessage({id:"scaleLabel",defaultMessage:s.scaleLabel}),e.React.createElement(r.Select,{onChange:e=>{const t=parseInt(e.target.value);y(t),l(t,h)},value:b},p.map((t=>{var a;return e.React.createElement(r.Option,{value:`${t}`,key:t},`1:${null===(a=t.toString().match(/(\d+?)(?=(\d{3})+(?!\d)|$)/g))||void 0===a?void 0:a.join(".")}`)}))))),e.React.createElement(r.CardFooter,{className:"d-flex justify-content-center"},M?e.React.createElement(r.Button,{type:"primary",onClick:()=>{L.current&&(L.current.abort(),w(!1))}},a.formatMessage({id:"buttonCancel",defaultMessage:s.buttonCancel})):e.React.createElement(r.Button,{type:"primary",onClick:()=>{w(!0);const e=new c.default({layout:h,format:"pdf",layoutOptions:{titleText:u,scalebarUnit:"Kilometers",customTextElements:[]},exportOptions:{dpi:98},scalePreserved:!0,outScale:b}),r=new o.default({view:t,template:e});L.current=new AbortController,n.default.execute("https://gis.geosphere.at/maps/rest/services/tools/printing/GPServer/Export%20Web%20Map",r,{signal:L.current.signal}).then(C).catch(A)}},a.formatMessage({id:"buttonPrint",defaultMessage:s.buttonPrint}))))}var h=l(72),v=l.n(h);const{useState:b,useRef:y,useEffect:M}=e.React;function w(e,t,r){return e<t?t:e>r?r:e}const x=n=>{const[o,c]=b(null),[s,i]=b(!1),l=y(null),u=y(null);M((()=>{i(!0);const e=l.current.closest(".panel-container"),t=new MutationObserver((e=>{for(const t of e)"attributes"===t.type&&(i(!t.target.classList.contains("d-none")),t.target.classList.contains("d-none")?u.current.style.display="none":u.current.style.display="block")}));e&&t.observe(e,{attributeFilter:["class"]})}),[]),M((()=>{if(o){const t=document.querySelector(".esri-view-root"),r=document.createElement("div");t.append(r);const[a,n]=d(1e4,"A4 Hochformat"),[o,c,s,i]=m(a,n),l={position:"absolute",top:c+"px",left:o+"px",width:s+"px",height:i+"px",backgroundColor:"#fca5a5",opacity:"50%",border:"2px solid #db2525",pointerEvents:"none"},p=()=>e.React.createElement("div",{ref:u,style:l});return e.ReactDOM.render(e.React.createElement(p,null),r),()=>{for(;r.firstChild;)r.removeChild(r.firstChild)}}}),[o]);const d=(e,t)=>[f[t][0]*e/1e3,f[t][1]*e/1e3],m=(e,t)=>{const r=o.center,n=r.x-e/2,c=r.x+e/2,s=r.y-t/2,i=r.y+t/2,l=o.toScreen(new a.default({x:n,y:i,spatialReference:{wkid:o.spatialReference.wkid}})),u=o.toScreen(new a.default({x:c,y:s,spatialReference:{wkid:o.spatialReference.wkid}}));return[w(Math.round(l.x),0,o.width),w(Math.round(l.y),0,o.height),w(Math.round(u.x-l.x),0,o.width),w(Math.round(u.y-l.y),0,o.height)]};return e.React.createElement("div",{className:"widget-print",ref:l},n.useMapWidgetIds&&0===n.useMapWidgetIds.length&&e.React.createElement(r.WidgetPlaceholder,{icon:v(),widgetId:n.id,message:"Please select a map widget!"}),n.useMapWidgetIds&&1===n.useMapWidgetIds.length&&e.React.createElement(t.JimuMapViewComponent,{useMapWidgetId:n.useMapWidgetIds[0],onActiveViewChange:e=>{c(e.view)}}),o&&n.intl&&e.React.createElement(g,{view:o,intl:n.intl,updatePreview:(e,t)=>{if(s){const[r,a]=d(e,t);((e,t)=>{const[r,a,n,o]=m(e,t);u&&u.current&&(u.current.style.display="block",u.current.style.left=r+"px",u.current.style.top=a+"px",u.current.style.width=n+"px",u.current.style.height=o+"px")})(r,a)}}}))};function R(e){l.p=e}})(),u})())}}}));